<div class="fullContainer">
    <!-- Título del departamento -->
    <h2 class="text-4xl font-bold mb-8 text-center">
        Department: <%= department.title %>
    </h2>

    <!-- Grid centrado de 3 tarjetas por fila -->
    <div
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-8 items-center"
        id="employeesContainer"
    >
        <!-- inicialmente vacío; lo llenamos con JS -->
    </div>

    <div class="flex justify-center gap-3 mt-6 mb-4">
        <button id="prevPage" class="btnPrimary">Previous</button>
        <button id="nextPage" class="btnPrimary">Next</button>
    </div>
</div>

<script>
    const departmentID = "<%= department.departmentID %>";
    let currentPage = 1;

    async function loadEmployees(page) {
        const response = await fetch(
            `/department/${departmentID}/find?page=${page}`
        );
        const data = await response.json();

        let container = "";
        if (data.length === 0) {
            container = `
        <div class="w-full bg-neutral-800/50 rounded-2xl shadow-lg p-6 flex flex-col col-span-full text-center">
            There´s no more employees
        </div>`;
        } else {
            data.forEach((user) => {
                container += `
        <div class="w-full bg-neutral-800/50 rounded-2xl shadow-lg p-6 flex flex-col">
            <h2 class="text-2xl font-semibold mb-4">
                ${user.birthName} ${user.surname}
            </h2>
            <p class="mb-2">
                <span class="font-medium">WorkModality:</span>
                ${
                    user.workModality === 0
                        ? "On Site"
                        : user.workModality === 1
                        ? "Remote"
                        : "Hybrid"
                }
                </p>
            <p class="mb-2"><span class="font-medium">E-mail:</span> ${
                user.mail
            }</p>
            <p class="mb-0">
                <span class="font-medium">Phone Number:</span>
                ${user.phoneNumber || "N/A"}
            </p>
            <a href="/employee/${user.userID}"
                class="btnPrimary mt-3 text-center">
                Check
                </a>
        </div>`;
            });
        }

        document.getElementById("employeesContainer").innerHTML = container;
    }

    document.getElementById("prevPage").addEventListener("click", () => {
        if (currentPage > 1) {
            currentPage--;
            loadEmployees(currentPage);
        }
    });
    document.getElementById("nextPage").addEventListener("click", () => {
        currentPage++;
        loadEmployees(currentPage);
    });

    // primera carga
    loadEmployees(currentPage);
</script>
