<div class="container mx-auto p-4">
    <h2 class="text-3xl font-semibold mb-2">All Departments</h2>

    <% if (role == 'Human Resources') { %>
        <a class="btnPrimary" href="/department/add">Add department</a>
    <% } %>

    <div
        class="bg-neutral-700/25 flex flex-col items-center justify-start py-5"
        id="departmentContainer"
    ></div>

    <div class="flex justify-center gap-3 mt-6">
        <button id="prevPage" class="btnPrimary">Previous</button>
        <button id="nextPage" class="btnPrimary">Next</button>
    </div>
</div>

<script>
    let currentPage = 1;

    async function LoadDepartments(page) {
        const response = await fetch(`/department/search?page=${page}`);
        const data = await response.json();

        let container = "";

        if (data.length === 0) {
            container += `<p>There´s no departments </p>`;
        } else {
            data.forEach((dept) => {
                container += `<div class="w-[70%] bg-neutral-700/25 shadow-md rounded-2xl p-6 mb-4 flex">
                    <div class="w-4/5 pr-6 flex flex-col justify-center">
                <h2 class="text-2xl font-semibold mb-2">Name: ${dept.title} </h2>
                <p class="mb-1">
                <span class="font-medium">Status:</span>`;

                if (dept.status === 1) {
                    container += `<span class="text-green-600"> Active </span>`;
                } else {
                    container += `<span class="text-yellow-500"> Inactive </span>`;
                }

                container += `</p>
                    <p><span class="font-medium">Enterprise:</span> ${dept.enterprise}</p>
                    </div>
                    <div class="w-1/5 flex flex-col items-end justify-center gap-2 text-center">`;
                container += `<a href="/department/${dept.departmentID}"
                    class="block bg-blue-500 px-4 py-2 rounded-xl w-full hover:bg-blue-600 transition">
                    Check</a>
                    <a href="/department/${dept.departmentID}/modify"
                    class="bg-yellow-500 px-4 py-2 rounded-xl w-full hover:bg-yellow-600 transition">
                    Modify</a>
                    </div>
                    </div>`;
            });
        }
        document.getElementById("departmentContainer").innerHTML = container;
    }

    document.getElementById("prevPage").addEventListener("click", () => {
        if (currentPage > 1) {
            currentPage--;
            LoadDepartments(currentPage);
        }
    });

    document.getElementById("nextPage").addEventListener("click", () => {
        currentPage++;
        LoadDepartments(currentPage);
    });

    // Cargar la primera página al iniciar
    LoadDepartments(currentPage);
</script>
