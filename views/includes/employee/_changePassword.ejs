<% if (passwdFlag !== 0) { %>
    <script>addBackButton('/employee/me');</script>
<% } %>

<div class="primaryContainer bgContainer1">
    
    <div class="titleContainer">
        <h2 class="title text-center flex-1">Update password</h2>
    </div>

    <% if (passwdFlag === 0) { %>
        As your first time logging in, you MUST have to change your password to continue navigating.
    <% } %>
    <form id="form" action="/employee/me/changePassword" method="POST">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <div class="grid grid-cols-1">
            <% if (passwdFlag === 1) { %>
            <div class="relative">
                <label class="label">Current Password:</label>
                <input
                    type="password"
                    id="currentPassword"
                    name="currentPassword"
                    class="input"
                    required
                />
                <button type="button" onclick="togglePassword('currentPassword', this)" class="absolute right-4 top-8.5 text-sm text-neutral-400">
                    Show
                </button>
                <div id="currentPasswordError" class="textDanger text-sm mt-2"></div>
            </div>
            <% } %>
            <div class="relative">
                <label class="label">New Password:</label>
                <input
                    type="password"
                    id="newPassword"
                    name="newPassword"
                    class="input"
                    required
                />
                <button type="button" onclick="togglePassword('newPassword', this)" class="absolute right-4 top-8.5 text-sm text-neutral-400">
                    Show
                </button>
                <div id="newPasswordError" class="textDanger text-sm mt-2"></div>
            </div>
            <div class="relative">
                <label class="label">Confirm New Password:</label>
                <input
                    type="password"
                    id="confirmNewPassword"
                    name="confirmNewPassword"
                    class="input"
                    required
                />
                <button type="button" onclick="togglePassword('confirmNewPassword', this)" class="absolute right-4 top-8.5 text-sm text-neutral-400">
                    Show
                </button>
                <div id="confirmPasswordError" class="textDanger text-sm mt-2"></div>
            </div>
        </div>

        <div class="endButtonsContainer">
            <button type="submit" class="btnPrimary">
                Update password
            </button>
        </div>
    </form>
</div>

<script src="/javascript/passwdValidator.js"></script>
<script>
    function togglePassword(inputId, btn) {
        const input = document.getElementById(inputId);
        if (input.type === "password") {
            input.type = "text";
            btn.textContent = "Hide";
        } else {
            input.type = "password";
            btn.textContent = "Show";
        }
    }
</script>
