@startuml

actor navegador as nav
boundary routes
boundary "Vista list.ejs" as list
control controller
entity Employee as emp
database mysql

autonumber

activate nav
nav -> routes: GET employee/department
deactivate nav
activate routes
routes -> controller: getEmployeesInDepartment(req, res)
deactivate routes

activate controller  
controller ->> emp: getLeaderDepartment(req.session.userID)
activate emp
emp ->> mysql: execute(`SELECT u.prioritaryDepartmentIDFK, d.title \nFROM user u JOIN department d \nON u.prioritaryDepartmentIDFK = d.departmentID \nWHERE u.userID= ?`, [req.session.userID])
activate mysql
mysql -->> emp: leaderDepartmentID
deactivate mysql
emp -->> controller: leaderDepartmentID
deactivate emp

controller ->> emp: getEmployeesInDepartment(leaderDepartmentID)
activate emp
emp ->> mysql: execute(`SELECT u.* FROM user u \nWHERE u.prioritaryDepartmentIDFK = ? \nORDER BY u.birthName ASC`, \n[leaderDepartmentID])
activate mysql
mysql -->> emp: rows
deactivate mysql
emp -->> controller: rows
deactivate emp
controller -> list: res.render("check.ejs", rows)
deactivate controller

activate list
list -> nav: HTML
deactivate list
activate nav

@enduml